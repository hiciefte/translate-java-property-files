# Repository Structure

This document outlines the structure and purpose of the files and directories within this project.

## Root Directory

- **`.git/`**: Contains Git version control information.
- **`.github/`**: Contains GitHub-specific files like workflows or issue templates.
  - **`workflows/`**: Contains GitHub Actions workflow files.
    - **`build-verify.yml`**: Defines a CI workflow that runs on pull requests. It lints the Dockerfile, scans dependencies and the final image for vulnerabilities, and verifies that the Docker image can be built successfully.
- **`.gitignore`**: Specifies intentionally untracked files that Git should ignore.
- **`.hadolint.yaml`**: Configuration file for the `hadolint` Dockerfile linter.
- **`.trivyignore`**: Configuration file for the `Trivy` vulnerability scanner.
- **`config.yaml`**: Configuration file for **manual/local runs**.
- **`docker/`**: Contains all files for building and running the Dockerized application.
  - **`.env.example`**: Example environment variable file. The user must copy this to `docker/.env` and customize it.
  - **`config.docker.yaml`**: Configuration file used *inside* the Docker container (mounted as `/app/config.yaml` by `docker-compose.yml`).
  - **`docker-compose.yml`**: Configures the Docker service (`translator`), manages environment variables (from `docker/.env` by default), and volume mounts.
  - **`docker-entrypoint.sh`**: Script run on container start; manages repository cloning/updating, GPG/user environment setup, and starts cron.
  - **`Dockerfile`**: Defines the Docker image, installs dependencies (Python, Git, GPG, CLIs), sets up `appuser`, and imports the bot GPG key.
  - **`translator-cron`**: Crontab file defining the scheduled execution of `update-translations.sh` via the entrypoint.
- **`docs/`**: Contains project documentation.
  - **`repository-structure.md`**: This file.
- **`glossary.json`**: Contains a glossary of terms for translation.
- **`LICENSE`**: Project's license file.
- **`logs/`**: (Created by the application, should be in `.gitignore`) Stores runtime logs from cron, `update-translations.sh`, and `translate_localization_files.py`.
- **`README.md`**: The primary project overview and setup guide.
- **`requirements-dev.in`**: Defines high-level **development and testing** dependencies.
- **`requirements-dev.txt`**: An auto-generated lockfile for development dependencies.
- **`requirements.in`**: Defines the high-level **production** dependencies. Edit this file to manage dependencies, then run `pip-compile requirements.in -o requirements.txt --upgrade --no-header --no-annotate`.
- **`requirements.txt`**: An auto-generated lockfile containing pinned production dependencies. Do not edit this file directly.
- **`SECURITY_STRATEGY.md`**: Outlines the security strategy for the project.
- **`secrets/`**: (Must be in `.gitignore`) Stores sensitive files.
  - **`gpg_bot_key/`**: Contains the bot's GPG public (`bot_public_key.asc`) and secret (`bot_secret_key.asc`) keys, copied into the Docker image.
- **`src/`**: Contains the main Python source code for the translation utilities.
- **`tests/`**: (If present) Contains test files for the project.
- **`update-translations.sh`**: Main orchestration shell script, run by cron inside the Docker container to perform the end-to-end translation workflow.
- **`venv/`**: (If used for local development) Contains Python virtual environment files.

## Key Files Overview

- **`docker/Dockerfile`**: Defines the Docker image. It sets up an Ubuntu environment, installs all necessary system and Python packages, creates a non-root `appuser`, and imports a dedicated bot GPG key.

- **`docker/docker-compose.yml`**: Configures and runs the `translator` Docker service, managing environment variables, build arguments, and volume mounts.

- **`docker/docker-entrypoint.sh`**: The script run on container start. It handles cloning/updating the target repository, setting up the `appuser` environment (GPG, Git), and starting the `cron` daemon.

- **`src/translate_localization_files.py`**: The core Python script that loads configuration, parses `.properties` files, interacts with the OpenAI API for translations, and writes the results.

- **`update-translations.sh`**: The main orchestration script. It sets up a Python virtual environment, installs dependencies from the `requirements.txt` lockfile, pulls from Transifex, runs the translation script, and manages the Git workflow (branching, committing, creating a PR, and pushing to Transifex).

- **`requirements.in` / `requirements-dev.in`**: These files define the high-level dependencies for production and development, respectively. They are the **source of truth** for package management.

- **`requirements.txt` / `requirements-dev.txt`**: These are lockfiles generated by `pip-tools` from the `.in` files. They contain the exact, pinned versions of all direct and transitive dependencies, ensuring reproducible builds. **Do not edit these files manually.**

- **`README.md`**: Provides the most current and comprehensive overview of the project, including setup, configuration, and usage. It is the primary source of truth for running the service.